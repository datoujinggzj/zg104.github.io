<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; --title-bar-height:20px; }
.mac-os-11 { --title-bar-height:28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
h1, h2, h3, h4, h5 { white-space: pre-wrap; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
thead, tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
svg { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; border-color: transparent !important; padding-top: 0px !important; padding-bottom: 0px !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  #write > p:nth-child(1) { margin-top: 0px; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
  figure { overflow-x: visible; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.reversefootnote { font-family: ui-monospace, sans-serif; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex:2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; overflow-wrap: anywhere; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }
mjx-container { break-inside: avoid; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


html {
	font-size: 19px;
}

html, body {
	margin: auto;
	background: #fefefe;
	-webkit-font-smoothing: antialiased;
}
body {
	font-family: "Vollkorn", Palatino, Times;
	color: #333;
	line-height: 1.4;
	text-align: justify;
}

#write {
	max-width: 960px;
	margin: 0 auto;
	margin-bottom: 2em;
	line-height: 1.53;
	padding-top: 40px;
}

@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1100px;
	}
}

@media print {
	html {
		font-size: 13px;
	}
}

/* Typography
-------------------------------------------------------- */

#write>h1:first-child,
h1 {
	margin-top: 1.6em;
	font-weight: normal;
}

h1 {
	font-size:3em;
}

h2 {
	margin-top:2em;
	font-weight: normal;
}

h3 {
	font-weight: normal;
	font-style: italic;
	margin-top: 3em;
}

h1, 
h2, 
h3{
	text-align: center;
}

h2:after{
	border-bottom: 1px solid #2f2f2f;
    content: '';
    width: 100px;
    display: block;
    margin: 0 auto;
    height: 1px;
}

h1+h2, h2+h3 {
	margin-top: 0.83em;
}

p,
.mathjax-block {
	margin-top: 0;
	-webkit-hypens: auto;
	-moz-hypens: auto;
	hyphens: auto;
}
ul {
	list-style: square;
	padding-left: 1.2em;
}
ol {
	padding-left: 1.2em;
}
blockquote {
	margin-left: 1em;
	padding-left: 1em;
	border-left: 1px solid #ddd;
}
code,
pre {
	font-family: "Consolas", "Menlo", "Monaco", monospace, serif;
	font-size: .9em;
	background: white;
}
.md-fences{
	margin-left: 1em;
	padding-left: 1em;
	border: 1px solid #ddd;
	padding-bottom: 8px;
	padding-top: 6px;
	margin-bottom: 1.5em;
}

a {
	color: #2484c1;
	text-decoration: none;
}
a:hover {
	text-decoration: underline;
}
a img {
	border: none;
}
h1 a,
h1 a:hover {
	color: #333;
	text-decoration: none;
}
hr {
	color: #ddd;
	height: 1px;
	margin: 2em 0;
	border-top: solid 1px #ddd;
	border-bottom: none;
	border-left: 0;
	border-right: 0;
}
.ty-table-edit {
	background: #ededed;
    padding-top: 4px;
}
table {
	margin-bottom: 1.333333rem
}
table th,
table td {
	padding: 8px;
	line-height: 1.333333rem;
	vertical-align: top;
	border-top: 1px solid #ddd
}
table th {
	font-weight: bold
}
table thead th {
	vertical-align: bottom
}
table caption+thead tr:first-child th,
table caption+thead tr:first-child td,
table colgroup+thead tr:first-child th,
table colgroup+thead tr:first-child td,
table thead:first-child tr:first-child th,
table thead:first-child tr:first-child td {
	border-top: 0
}
table tbody+tbody {
	border-top: 2px solid #ddd
}

.task-list{
	padding:0;
}

.md-task-list-item {
	padding-left: 1.6rem;
}

.md-task-list-item > input:before {
	content: '\221A';
	display: inline-block;
	width: 1.33333333rem;
  	height: 1.6rem;
	vertical-align: middle;
	text-align: center;
	color: #ddd;
	background-color: #fefefe;
}

.md-task-list-item > input:checked:before,
.md-task-list-item > input[checked]:before{
	color: inherit;
}
.md-tag {
	color: inherit;
	font: inherit;
}
#write pre.md-meta-block {
	min-height: 35px;
	padding: 0.5em 1em;
}
#write pre.md-meta-block {
	white-space: pre;
	background: #f8f8f8;
	border: 0px;
	color: #999;
	
	width: 100vw;
	max-width: calc(100% + 60px);
	margin-left: -30px;
	border-left: 30px #f8f8f8 solid;
	border-right: 30px #f8f8f8 solid;

	margin-bottom: 2em;
	margin-top: -1.3333333333333rem;
	padding-top: 26px;
	padding-bottom: 10px;
	line-height: 1.8em;
	font-size: 0.9em;
	font-size: 0.76em;
	padding-left: 0;
}
.md-img-error.md-image>.md-meta{
	vertical-align: bottom;
}
#write>h5.md-focus:before {
	top: 2px;
}

.md-toc {
	margin-top: 40px;
}

.md-toc-content {
	padding-bottom: 20px;
}

.outline-expander:before {
	color: inherit;
	font-size: 14px;
	top: auto;
	content: "\f0da";
	font-family: FontAwesome;
}

.outline-expander:hover:before,
.outline-item-open>.outline-item>.outline-expander:before {
  	content: "\f0d7";
}

/** source code mode */
#typora-source {
	font-family: Courier, monospace;
    color: #6A6A6A;
}

.html-for-mac #typora-sidebar {
    -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, .175);
    box-shadow: 0 6px 12px rgba(0, 0, 0, .175);
}

.cm-s-typora-default .cm-header, 
.cm-s-typora-default .cm-property,
.CodeMirror.cm-s-typora-default div.CodeMirror-cursor {
	color: #428bca;
}

.cm-s-typora-default .cm-atom, .cm-s-typora-default .cm-number {
	color: #777777;
}

.typora-node .file-list-item-parent-loc, 
.typora-node .file-list-item-time, 
.typora-node .file-list-item-summary {
	font-family: arial, sans-serif;
}

.md-task-list-item>input {
    margin-left: -1.3em;
    margin-top: calc(1rem - 12px);
}

.md-mathjax-midline {
	background: #fafafa;
}

.md-fences .code-tooltip {
	bottom: -2em !important;
}

.dropdown-menu .divider {
	border-color: #e5e5e5;
}


</style><title>KNN</title>
</head>
<body class='typora-export os-windows'><div class='typora-export-content'>
<div id='write'  class=''><h2 id='knn'><span>KNN</span></h2><p><img src="https://vatsalparsaniya.github.io/ML_Knowledge/_images/KNN.png" alt="K-Nearest neighbor clustering — Machine learning book" style="zoom:67%;" /></p><div class='md-toc' mdtype='toc'><p class="md-toc-content" role="list"><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n0"><a class="md-toc-inner" href="#knn">KNN</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n2"><a class="md-toc-inner" href="#key-takeaways">Key takeaways</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n26"><a class="md-toc-inner" href="#interview-questions">Interview Questions</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n73"><a class="md-toc-inner" href="#solutions">Solutions</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n78"><a class="md-toc-inner" href="#explain-the-k-nearest-neighbors-knn-algorithm-and-how-it-works">Explain the K-Nearest Neighbors (KNN) algorithm and how it works:</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n94"><a class="md-toc-inner" href="#what-is-the-role-of-k-in-knn-how-do-you-choose-an-optimal-value-for-k">What is the role of K in KNN? How do you choose an optimal value for K?</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n103"><a class="md-toc-inner" href="#what-distance-metrics-can-be-used-in-knn-explain-the-difference-between-euclidean-distance-and-manhattan-distance">What distance metrics can be used in KNN? Explain the difference between Euclidean distance and Manhattan distance.</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n138"><a class="md-toc-inner" href="#how-does-knn-handle-categorical-data-can-it-be-used-for-feature-selection">How does KNN handle categorical data? Can it be used for feature selection?</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n152"><a class="md-toc-inner" href="#what-are-the-advantages-and-disadvantages-of-using-knn">What are the advantages and disadvantages of using KNN?</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n192"><a class="md-toc-inner" href="#how-does-knn-deal-with-imbalanced-datasets-are-there-any-techniques-to-address-this-issue">How does KNN deal with imbalanced datasets? Are there any techniques to address this issue?</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n211"><a class="md-toc-inner" href="#can-knn-handle-missing-data-how-would-you-handle-missing-values-when-using-knn">Can KNN handle missing data? How would you handle missing values when using KNN?</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n225"><a class="md-toc-inner" href="#how-does-knn-handle-the-curse-of-dimensionality-what-techniques-can-be-used-to-address-this-problem">How does KNN handle the curse of dimensionality? What techniques can be used to address this problem?</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n244"><a class="md-toc-inner" href="#what-are-the-differences-between-knn-classification-and-knn-regression-how-are-the-predictions-made-in-each-case">What are the differences between KNN classification and KNN regression? How are the predictions made in each case?</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n279"><a class="md-toc-inner" href="#how-would-you-evaluate-the-performance-of-a-knn-model-what-metrics-can-be-used">How would you evaluate the performance of a KNN model? What metrics can be used?</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n298"><a class="md-toc-inner" href="#can-knn-be-used-for-outlier-detection-if-yes-how">Can KNN be used for outlier detection? If yes, how?</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n315"><a class="md-toc-inner" href="#what-is-the-impact-of-scaling-and-normalization-on-knn-should-you-always-preprocess-the-data-before-applying-knn">What is the impact of scaling and normalization on KNN? Should you always preprocess the data before applying KNN?</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n333"><a class="md-toc-inner" href="#what-are-some-techniques-to-speed-up-the-prediction-phase-of-knn-for-large-datasets">What are some techniques to speed up the prediction phase of KNN for large datasets?</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n364"><a class="md-toc-inner" href="#can-knn-handle-streaming-data-or-incremental-learning-explain-your-answer">Can KNN handle streaming data or incremental learning? Explain your answer.</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n481"><a class="md-toc-inner" href="#what-is-streaming-data">what is streaming data?</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n485"><a class="md-toc-inner" href="#what-is-incremental-learning">What is incremental learning?</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n376"><a class="md-toc-inner" href="#how-does-the-presence-of-irrelevant-features-affect-knn-performance-how-can-you-address-the-issue-of-feature-relevance">How does the presence of irrelevant features affect KNN performance? How can you address the issue of feature relevance?</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n397"><a class="md-toc-inner" href="#what-is-the-difference-between-instance-based-learning-and-model-based-learning-which-category-does-knn-fall-into">What is the difference between instance-based learning and model-based learning? Which category does KNN fall into?</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n449"><a class="md-toc-inner" href="#can-knn-be-used-for-text-classification-if-yes-how-would-you-represent-text-data-for-knn">Can KNN be used for text classification? If yes, how would you represent text data for KNN?</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n514"><a class="md-toc-inner" href="#how-does-the-concept-of-cross-validation-apply-to-knn-why-is-it-important">How does the concept of cross-validation apply to KNN? Why is it important?</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n526"><a class="md-toc-inner" href="#are-there-any-variations-or-extensions-of-knn-can-you-mention-a-few-and-explain-their-advantages">Are there any variations or extensions of KNN? Can you mention a few and explain their advantages?</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n545"><a class="md-toc-inner" href="#how-can-you-interpret-the-results-of-a-knn-model-what-insights-can-you-gain-from-the-nearest-neighbors">How can you interpret the results of a KNN model? What insights can you gain from the nearest neighbors?</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n565"><a class="md-toc-inner" href="#python-application">Python Application</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n566"><a class="md-toc-inner" href="#using-sklearn">Using Sklearn</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n579"><a class="md-toc-inner" href="#kneighborsclassifier"><code>KNeighborsClassifier()</code></a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n643"><a class="md-toc-inner" href="#from-scratch">From Scratch</a></span></p></div><p>&nbsp;</p><h3 id='key-takeaways'><span>Key takeaways</span></h3><ol><li><p><span>KNN is a simple yet effective machine learning algorithm used for both classification and regression tasks. It is a non-parametric method, meaning it does not make any assumptions about the underlying data distribution.</span></p></li><li><p><span>The algorithm works by finding the K nearest neighbors to a given data point based on a distance metric (e.g., Euclidean distance) and assigning a label or predicting a value based on the majority vote or average of the labels/values of its neighbors.</span></p></li><li><p><span>KNN is a lazy learning algorithm, which means it does not involve a training phase. Instead, during the prediction phase, it calculates the distances between the new data point and all existing data points in the training set.</span></p></li><li><p><span>The choice of the value of K in KNN is critical. A small K value can make the algorithm more sensitive to noise and outliers, while a large K value can lead to oversmoothing and loss of local patterns. The optimal value of K is often determined through cross-validation.</span></p></li><li><p><span>KNN can handle both numerical and categorical data. However, it requires the data to be preprocessed and normalized because the algorithm relies on the distance metric, which can be influenced by the scales and units of the features.</span></p></li><li><p><span>KNN does not provide explicit rules or feature importance. It considers all features equally and assumes that the features contributing to the decision are locally correlated with the target variable.</span></p></li><li><p><span>KNN is computationally expensive, especially for large datasets. Since it calculates the distances for every data point in the training set, the prediction time can be slow. Various techniques, such as KD-trees or ball trees, can be used to speed up the search process.</span></p></li><li><p><span>KNN is sensitive to the curse of dimensionality. As the number of features or dimensions increases, the algorithm may struggle to find meaningful neighbors because the distances between points tend to converge. Dimensionality reduction techniques or feature selection can help mitigate this issue.</span></p></li><li><p><span>KNN is a versatile algorithm that can be used for various applications such as recommendation systems, image recognition, anomaly detection, and more. It can also be used as a baseline model for benchmarking other complex algorithms.</span></p></li><li><p><span>KNN is a relatively interpretable algorithm. Since it relies on the concept of nearest neighbors, it can provide insights into the decision-making process by examining the neighbors and their characteristics.</span></p></li></ol><h3 id='interview-questions'><span>Interview Questions</span></h3><ol><li><p><span>Explain the K-Nearest Neighbors (KNN) algorithm and how it works.</span></p></li><li><p><span>What is the role of K in KNN? How do you choose an optimal value for K?</span></p></li><li><p><span>What distance metrics can be used in KNN? Explain the difference between Euclidean distance and Manhattan distance.</span></p></li><li><p><span>How does KNN handle categorical data? Can it be used for feature selection?</span></p></li><li><p><span>What are the advantages and disadvantages of using KNN?</span></p></li><li><p><span>How does KNN deal with imbalanced datasets? Are there any techniques to address this issue?</span></p></li><li><p><span>Can KNN handle missing data? How would you handle missing values when using KNN?</span></p></li><li><p><span>How does KNN handle the curse of dimensionality? What techniques can be used to address this problem?</span></p></li><li><p><span>What are the differences between KNN classification and KNN regression? How are the predictions made in each case?</span></p></li><li><p><span>How would you evaluate the performance of a KNN model? What metrics can be used?</span></p></li><li><p><span>Can KNN be used for outlier detection? If yes, how?</span></p></li><li><p><span>What is the impact of scaling and normalization on KNN? Should you always preprocess the data before applying KNN?</span></p></li><li><p><span>What are some techniques to speed up the prediction phase of KNN for large datasets?</span></p></li><li><p><span>Can KNN handle streaming data or incremental learning? Explain your answer.</span></p></li><li><p><span>How does the presence of irrelevant features affect KNN performance? How can you address the issue of feature relevance?</span></p></li><li><p><span>What is the difference between instance-based learning and model-based learning? Which category does KNN fall into?</span></p></li><li><p><span>Can KNN be used for text classification? If yes, how would you represent text data for KNN?</span></p></li><li><p><span>How does the concept of cross-validation apply to KNN? Why is it important?</span></p></li><li><p><span>Are there any variations or extensions of KNN? Can you mention a few and explain their advantages?</span></p></li><li><p><span>How can you interpret the results of a KNN model? What insights can you gain from the nearest neighbors?</span></p></li></ol><h3 id='solutions'><span>Solutions</span></h3><h4 id='explain-the-k-nearest-neighbors-knn-algorithm-and-how-it-works'><span>Explain the K-Nearest Neighbors (KNN) algorithm and how it works:</span></h4><p><span>The K-Nearest Neighbors (KNN) algorithm is a simple and versatile machine learning algorithm used for both classification and regression tasks. It operates based on the principle that data points that are close to each other are likely to belong to the same class or exhibit similar properties.</span></p><p><span>Here&#39;s how the algorithm works:</span></p><ol><li><p><span>Training Phase: During the training phase, KNN simply stores the labeled data points in memory.</span></p></li><li><p><span>Prediction Phase: When a new unlabeled data point is provided for prediction, the algorithm calculates the distances between that point and all the training data points. The most common distance metric used is the Euclidean distance, but other distance metrics can be used as well.</span></p></li><li><p><span>Nearest Neighbor Selection: The algorithm selects the K data points from the training set that are closest to the new data point based on the calculated distances. These data points are known as the &quot;nearest neighbors.&quot;</span></p></li><li><p><span>Voting (Classification) or Averaging (Regression): For classification tasks, KNN assigns the class label that is most frequent among the K nearest neighbors. In the case of regression tasks, KNN predicts the average of the target variable values of the K nearest neighbors.</span></p></li><li><p><span>Output: The predicted class label or value is returned as the output of the algorithm.</span></p></li></ol><h4 id='what-is-the-role-of-k-in-knn-how-do-you-choose-an-optimal-value-for-k'><span>What is the role of K in KNN? How do you choose an optimal value for K?</span></h4><p><span>The value of K in KNN determines the number of neighbors that will be considered when making predictions. It is a critical parameter that can significantly affect the performance of the algorithm.</span></p><p><span>The role of K can be summarized as follows:</span></p><ul><li><p><span>For smaller values of K, the model becomes more sensitive to noise and outliers. It may lead to overfitting and poor generalization because the decision boundary can be excessively influenced by a few nearby points.</span></p></li><li><p><span>For larger values of K, the model becomes more stable and less sensitive to individual data points. However, it may lose the ability to capture local patterns and variations in the data.</span></p></li></ul><p><span>To choose an optimal value for K, a common approach is to perform model selection using techniques like cross-validation. The data is divided into training and validation sets, and different values of K are tested. The value of K that yields the best performance (e.g., highest accuracy or lowest error) on the validation set is selected as the optimal value.</span></p><h4 id='what-distance-metrics-can-be-used-in-knn-explain-the-difference-between-euclidean-distance-and-manhattan-distance'><span>What distance metrics can be used in KNN? Explain the difference between Euclidean distance and Manhattan distance.</span></h4><ol><li><p><span>In KNN, various distance metrics can be used to measure the similarity or dissimilarity between data points. Some common distance metrics include:</span></p><ol><li><p><span>Euclidean Distance: Euclidean distance is the most widely used distance metric in KNN. It calculates the straight-line distance between two points in Euclidean space. For two points (p1, q1) and (p2, q2), the Euclidean distance is given by the formula:</span></p><p><img src="https://latex.codecogs.com/png.latex?%5Csqrt%7B%28p2%20-%20p1%29%5E2%20%2B%20%28q2%20-%20q1%29%5E2%7D" referrerpolicy="no-referrer" alt="Euclidean distance formula"></p><p><span>Euclidean distance considers the coordinates of the points as dimensions and calculates the shortest distance between them. It assumes that all dimensions are equally important and contributes to the overall distance equally.</span></p></li><li><p><span>Manhattan Distance: Manhattan distance, also known as the city block distance or L1 norm, calculates the distance between two points by summing the absolute differences of their coordinates. For two points (p1, q1) and (p2, q2), the Manhattan distance is given by the formula:</span></p><p><img src="https://latex.codecogs.com/png.latex?%7Cp2%20-%20p1%7C%20+%20%7Cq2%20-%20q1%7C" referrerpolicy="no-referrer" alt="Manhattan distance formula"></p><p><span>Manhattan distance gets its name from the idea of navigating through a city block, where you can only move along the grid-like streets. It measures the distance by summing the differences along each dimension, making right-angle turns. It is particularly useful when dealing with data that is constrained to move along orthogonal axes.</span></p></li></ol><p><span>The main difference between Euclidean distance and Manhattan distance lies in how they measure distance. Euclidean distance calculates the shortest straight-line distance between two points, treating their coordinates as dimensions. It captures the direct spatial relationship between points. On the other hand, Manhattan distance calculates the distance by summing the absolute differences along each dimension. It measures the &quot;city block&quot; distance, considering only horizontal and vertical movements. Manhattan distance is more suitable when movement is constrained to specific axes and right-angle turns are required.</span></p><p><span>In KNN, the choice of distance metric depends on the nature of the data and the problem at hand. Other distance metrics, such as Minkowski distance, Mahalanobis distance, or cosine distance, can also be used based on specific requirements and data characteristics.</span></p></li></ol><h4 id='how-does-knn-handle-categorical-data-can-it-be-used-for-feature-selection'><span>How does KNN handle categorical data? Can it be used for feature selection?</span></h4><p><span>KNN can handle categorical data by using appropriate distance metrics that are suitable for categorical variables. One common approach is to use the Hamming distance or the simple matching distance, which count the number of mismatches or matches between two categorical feature vectors, respectively. These distance metrics treat categorical variables as binary variables, where a match is considered as 0 and a mismatch as 1.</span></p><p><span>To handle categorical data, the data preprocessing step involves converting categorical variables into numerical representations. This can be done through techniques like one-hot encoding, where each category is transformed into a binary feature. Once the categorical data is converted into numerical format, KNN can be applied in the same way as with numerical data.</span></p><p><span>Regarding feature selection, KNN itself does not inherently perform feature selection. However, you can use KNN as part of a feature selection process. One common approach is to use KNN to evaluate the performance of different subsets of features. By iteratively selecting subsets of features and evaluating the KNN performance, you can identify the subset that yields the best results. This process can help in feature selection by finding the most informative features for the given task.</span></p><h4 id='what-are-the-advantages-and-disadvantages-of-using-knn'><span>What are the advantages and disadvantages of using KNN?</span></h4><p><span>Advantages of using KNN:</span></p><ul><li><p><span>Simplicity: KNN is easy to understand and implement. It has a straightforward intuition and does not involve complex mathematical equations.</span></p></li><li><p><span>Versatility: KNN can be used for both classification and regression tasks. It can handle various types of data, including numerical and categorical variables.</span></p></li><li><p><span>No training phase: KNN is a lazy learning algorithm, meaning it does not require an explicit training phase. The model is built during the prediction phase, making it computationally efficient for training on large datasets.</span></p></li><li><p><span>Interpretable: KNN provides interpretability as it allows you to examine the neighbors and their characteristics, helping to gain insights into the decision-making process.</span></p></li></ul><p><span>Disadvantages of using KNN:</span></p><ul><li><p><span>Computational complexity: KNN can be computationally expensive, especially when dealing with large datasets. As the size of the training set increases, the prediction time also increases since distances need to be calculated for every training point.</span></p></li><li><p><span>Sensitivity to feature scaling: KNN relies on distance metrics, and the choice of distance can be sensitive to the scales of the features. It is important to scale and normalize the features before applying KNN to avoid bias towards certain features.</span></p></li><li><p><span>Determining the optimal K value: The choice of the K parameter in KNN is crucial and needs to be determined carefully. An inappropriate value of K can lead to overfitting or underfitting. It often requires experimentation and model selection techniques to find the optimal K value.</span></p></li><li><p><span>Imbalanced data: KNN can be biased towards the majority class in imbalanced datasets. The class distribution affects the nearest neighbors, and the majority class can dominate the prediction. Techniques such as weighted KNN or resampling methods can help mitigate this issue.</span></p></li></ul><p><span>Overall, while KNN is a simple and effective algorithm, it is important to consider its computational complexity, sensitivity to scaling, and appropriate handling of categorical data and imbalanced datasets.</span></p><h4 id='how-does-knn-deal-with-imbalanced-datasets-are-there-any-techniques-to-address-this-issue'><span>How does KNN deal with imbalanced datasets? Are there any techniques to address this issue?</span></h4><p><span>KNN can be biased towards the majority class in imbalanced datasets because the majority class tends to dominate the nearest neighbors. To address this issue, several techniques can be applied:</span></p><ul><li><p><span>Weighted KNN: Assigning higher weights to the instances of the minority class can help balance the influence of different classes during the prediction phase. This ensures that the minority class has a stronger impact on the decision boundary.</span></p></li><li><p><span>Resampling methods: Techniques such as oversampling the minority class (e.g., Random Oversampling, SMOTE) or undersampling the majority class (e.g., Random Undersampling, Cluster Centroids) can help balance the class distribution. These methods create synthetic samples or reduce the number of majority class samples to achieve a more balanced representation.</span></p></li><li><p><span>Ensemble methods: Using ensemble techniques like Balanced Bagging or Balanced Random Forest can help improve the performance on imbalanced datasets. These methods combine multiple KNN models trained on different balanced subsets of the data, reducing the bias towards the majority class.</span></p></li></ul><h4 id='can-knn-handle-missing-data-how-would-you-handle-missing-values-when-using-knn'><span>Can KNN handle missing data? How would you handle missing values when using KNN?</span></h4><p><span>KNN does not handle missing data explicitly, and missing values can cause issues during the distance calculations. To handle missing values when using KNN, some common approaches include:</span></p><ul><li><p><span>Data imputation: Missing values can be replaced or imputed with estimated values. Common imputation techniques include mean imputation, median imputation, mode imputation, or more advanced methods like regression imputation or k-nearest neighbor imputation. After imputing the missing values, KNN can be applied to the imputed dataset.</span></p></li><li><p><span>Distance weighting: Another approach is to modify the distance calculations to give less weight to missing values or assign them a specific value that reflects their absence. This ensures that missing values do not dominate the distance computations and allow KNN to work with incomplete data.</span></p></li></ul><h4 id='how-does-knn-handle-the-curse-of-dimensionality-what-techniques-can-be-used-to-address-this-problem'><span>How does KNN handle the curse of dimensionality? What techniques can be used to address this problem?</span></h4><p><span>The curse of dimensionality refers to the challenges that arise when working with high-dimensional data. KNN can be affected by the curse of dimensionality because as the number of dimensions increases, the density of data points decreases, and distances tend to become less meaningful. To address this problem, some techniques can be employed:</span></p><ul><li><p><span>Dimensionality reduction: Techniques like Principal Component Analysis (PCA), Linear Discriminant Analysis (LDA), or t-SNE can be used to reduce the dimensionality of the data while preserving the most important information. These methods transform the data into a lower-dimensional space, reducing the impact of irrelevant or redundant features.</span></p></li><li><p><span>Feature selection: Selecting a subset of relevant features can help mitigate the curse of dimensionality. Feature selection methods such as Recursive Feature Elimination (RFE), L1 regularization (Lasso), or information gain can be applied to identify the most informative features that contribute to the prediction.</span></p></li><li><p><span>Manifold learning: Manifold learning techniques like Locally Linear Embedding (LLE), Isomap, or Laplacian Eigenmaps can help uncover the underlying low-dimensional structure of the data by preserving local relationships. These methods can reveal a more meaningful representation of the data, reducing the impact of high-dimensional noise.</span></p></li></ul><h4 id='what-are-the-differences-between-knn-classification-and-knn-regression-how-are-the-predictions-made-in-each-case'><span>What are the differences between KNN classification and KNN regression? How are the predictions made in each case?</span></h4><p><span>The differences between KNN classification and KNN regression lie in the nature of the prediction task and the way predictions are made:</span></p><p><span>KNN Classification:</span></p><ul><li><p><span>Prediction Task: KNN classification is used for categorical or discrete prediction tasks, where the goal is to assign a class label to a new data point.</span></p></li><li><p><span>Prediction Method: The prediction in KNN classification is made through majority voting. The class label that appears most frequently among the K nearest neighbors is assigned as the predicted class for the new data point. Each neighbor&#39;s class label contributes equally to the final decision.</span></p></li><li><p><span>Output: The output of KNN classification is a class label or a categorical value.</span></p></li></ul><p><span>KNN Regression:</span></p><ul><li><p><span>Prediction Task: KNN regression is used for continuous prediction tasks, where the goal is to predict a continuous or numeric value for a new data point.</span></p></li><li><p><span>Prediction Method: The prediction in KNN regression is made through averaging. Instead of assigning a class label, the target values of the K nearest neighbors are averaged, and the resulting average is used as the predicted value for the new data point. The predicted value is a continuous value that represents the average of the target variable values of the neighbors.</span></p></li><li><p><span>Output: The output of KNN regression is a continuous value or a numeric prediction.</span></p></li></ul><p><span>In summary, KNN classification is used for categorical prediction tasks, and predictions are made through majority voting, while KNN regression is used for continuous prediction tasks, and predictions are made through averaging the target values of the nearest neighbors.</span></p><h4 id='how-would-you-evaluate-the-performance-of-a-knn-model-what-metrics-can-be-used'><span>How would you evaluate the performance of a KNN model? What metrics can be used?</span></h4><p><span>To evaluate the performance of a KNN model, several metrics can be used depending on the specific task:</span></p><ul><li><p><span>Accuracy: Accuracy measures the overall correctness of the predictions by calculating the ratio of correctly classified instances to the total number of instances. It is commonly used for balanced datasets.</span></p></li><li><p><span>Precision, Recall, and F1-score: These metrics are useful for imbalanced datasets and binary classification tasks. Precision measures the proportion of correctly predicted positive instances, while recall measures the proportion of actual positive instances correctly predicted. F1-score is the harmonic mean of precision and recall, providing a balanced measure of performance.</span></p></li><li><p><span>Confusion Matrix: A confusion matrix provides a detailed breakdown of the predicted versus actual class labels. It shows true positives, true negatives, false positives, and false negatives, allowing you to analyze the specific types of errors made by the KNN model.</span></p></li><li><p><span>ROC Curve and AUC: ROC (Receiver Operating Characteristic) curve plots the true positive rate against the false positive rate at various classification thresholds. AUC (Area Under the Curve) summarizes the ROC curve&#39;s performance, providing a single-value measure of the model&#39;s discriminatory power.</span></p></li></ul><p><span>The choice of evaluation metric depends on the specific problem, the class distribution, and the desired trade-offs between different types of errors.</span></p><h4 id='can-knn-be-used-for-outlier-detection-if-yes-how'><span>Can KNN be used for outlier detection? If yes, how?</span></h4><p><span>Yes, KNN can be used for outlier detection. The basic idea is that outliers are expected to have fewer neighboring data points compared to the majority of the data. The approach involves the following steps:</span></p><ul><li><p><span>Calculate the distance between each data point and its K nearest neighbors.</span></p></li><li><p><span>Sort the distances in ascending order for each data point.</span></p></li><li><p><span>Identify data points that have significantly larger distances compared to their neighbors. These data points can be considered outliers.</span></p></li></ul><p><span>The choice of K is important as it determines the neighborhood size and affects the sensitivity of outlier detection. Smaller values of K make the algorithm more sensitive to outliers.</span></p><h4 id='what-is-the-impact-of-scaling-and-normalization-on-knn-should-you-always-preprocess-the-data-before-applying-knn'><span>What is the impact of scaling and normalization on KNN? Should you always preprocess the data before applying KNN?</span></h4><p><span>Scaling and normalization have a significant impact on KNN because the algorithm relies on distance calculations. If the features have different scales or units, those with larger values may dominate the distance computations, leading to biased results.</span></p><p><span>It is generally recommended to preprocess the data before applying KNN by scaling or normalizing the features. Common techniques include:</span></p><ul><li><p><span>Min-Max Scaling: Rescales the features to a specific range (e.g., [0, 1]) by subtracting the minimum value and dividing by the range.</span></p></li><li><p><span>Standardization: Transforms the features to have zero mean and unit variance by subtracting the mean and dividing by the standard deviation.</span></p></li><li><p><span>Other scaling methods: Additional scaling methods like Robust Scaling (using median and interquartile range) or Max Absolute Scaling (dividing by the maximum absolute value) may also be applicable depending on the data distribution and requirements.</span></p></li></ul><p><span>Preprocessing the data helps to ensure that each feature contributes equally to the distance calculations and avoids biases due to different scales. However, it&#39;s worth noting that some distance metrics, such as Hamming distance for categorical variables, do not require scaling.</span></p><h4 id='what-are-some-techniques-to-speed-up-the-prediction-phase-of-knn-for-large-datasets'><span>What are some techniques to speed up the prediction phase of KNN for large datasets?</span></h4><p><span>For large datasets, the prediction phase of KNN can be computationally expensive due to distance calculations for each test instance. Here are some techniques to speed up the prediction phase:</span></p><ol><li><p><span>Approximate Nearest Neighbor (ANN) Search: ANN algorithms, such as k-d trees, ball trees, or locality-sensitive hashing (LSH), can be used to index the training data and accelerate the search for nearest neighbors. These algorithms create efficient data structures that allow for faster neighbor retrieval, reducing the overall prediction time.</span></p></li><li><p><span>Dimensionality Reduction: Applying dimensionality reduction techniques, such as Principal Component Analysis (PCA) or t-SNE, can help reduce the number of features or compress the data while preserving most of the information. By working with a lower-dimensional representation, the number of distance calculations decreases, leading to faster predictions.</span></p></li><li><p><span>Nearest Neighbor Precomputation: If the dataset is static or changes infrequently, you can precompute the nearest neighbors for each training instance and store them. During the prediction phase, instead of recalculating the neighbors, you can directly retrieve them from the precomputed results, significantly reducing the computation time.</span></p></li><li><p><span>Parallelization: Utilize parallel processing techniques to distribute the distance calculations across multiple processors or machines. This can be achieved using parallel computing libraries or frameworks like multiprocessing or Spark. Parallelization can greatly speed up the prediction phase, especially for large-scale datasets.</span></p></li><li><p><span>Data Sampling: If the dataset is too large to handle efficiently, you can consider sampling a representative subset of the data. By selecting a smaller subset that maintains the distribution of the original data, you can reduce the computation time while preserving the overall characteristics of the dataset. However, be cautious as this may introduce a trade-off between computational efficiency and the accuracy of the predictions.</span></p></li><li><p><span>Algorithmic Optimization: Implementing efficient algorithms or data structures specifically designed for KNN can also help speed up the prediction phase. For example, using efficient distance calculation techniques, such as vectorized operations or optimized libraries, can improve the overall performance.</span></p></li></ol><p><span>It&#39;s important to note that the choice of technique depends on the specific characteristics of the dataset, available computing resources, and the trade-offs between accuracy and computation time. It&#39;s recommended to experiment with different approaches and evaluate their impact on both speed and prediction quality.</span></p><h4 id='can-knn-handle-streaming-data-or-incremental-learning-explain-your-answer'><span>Can KNN handle streaming data or incremental learning? Explain your answer.</span></h4><p><span>KNN is not inherently designed for streaming data or incremental learning. Traditional KNN requires the entire training dataset to be present during the prediction phase because it calculates distances based on the complete set of training instances. This makes it impractical to update the model in real-time as new data arrives.</span></p><p><span>However, there are techniques that can be applied to adapt KNN for streaming data or incremental learning scenarios. One approach is to use approximate nearest neighbor algorithms, such as online or incremental KNN. These algorithms update the nearest neighbor structure as new data arrives, allowing for efficient and incremental updates to the model. Another approach is to use sliding window techniques, where a fixed-size window of the most recent data is maintained, and older data is discarded as new data arrives.</span></p><p><span>Overall, while KNN itself is not inherently suited for streaming data or incremental learning, with the use of appropriate adaptations and techniques, it is possible to make KNN work with streaming or incrementally arriving data.</span></p><h5 id='what-is-streaming-data'><span>what is streaming data?</span></h5><p><span>Streaming data refers to a continuous and potentially infinite flow of data that arrives in real-time or near real-time. It is generated from various sources such as social media feeds, sensors, logs, financial transactions, IoT devices, and more. Streaming data is characterized by its high volume, velocity, and variability. Unlike static datasets, streaming data is continuously updated and often requires real-time processing and analysis.</span></p><p><span>Streaming data poses unique challenges due to its dynamic nature and the need for timely processing. Traditional batch processing techniques may not be suitable for handling streaming data as it arrives in a continuous and unbounded manner. Streaming data processing systems are designed to handle data in motion and provide real-time insights, allowing organizations to react quickly to changing conditions, identify patterns, detect anomalies, and make timely decisions based on up-to-date information.</span></p><p><span>Examples of applications that deal with streaming data include real-time analytics, fraud detection, recommendation systems, network monitoring, sensor data analysis, and social media sentiment analysis.</span></p><h5 id='what-is-incremental-learning'><span>What is incremental learning?</span></h5><p><span>Incremental learning, also known as online learning or lifelong learning, refers to a machine learning paradigm where a model learns from new data instances as they arrive in a sequential manner. Unlike traditional batch learning, which involves retraining the model on the entire dataset whenever new data is added, incremental learning enables the model to update its knowledge incrementally without discarding previously learned information.</span></p><p><span>In incremental learning, the model learns from each new data instance and incorporates it into its existing knowledge, adjusting its parameters or updating its internal representation accordingly. This allows the model to adapt and evolve over time as new data becomes available.</span></p><p><span>The advantages of incremental learning include:</span></p><ol><li><p><span>Efficiency: Incremental learning avoids the need to retrain the model from scratch every time new data arrives, making it more computationally efficient, especially for large datasets.</span></p></li><li><p><span>Adaptability: The model can quickly adapt to changes in the data distribution or concept drift, as it continually learns from the most recent instances.</span></p></li><li><p><span>Scalability: Incremental learning enables handling large-scale datasets that may not fit entirely in memory, as it processes data instances one at a time or in small batches.</span></p></li><li><p><span>Real-time learning: With incremental learning, the model can update and improve its predictions in real-time, making it suitable for scenarios where immediate response or decision-making is required.</span></p></li></ol><p><span>However, there are challenges in incremental learning, such as managing the trade-off between retaining previous knowledge and incorporating new information, handling concept drift, avoiding catastrophic forgetting, and ensuring model stability. Careful consideration of techniques like regularization, forgetting mechanisms, memory management, and model architecture design is necessary to maintain a good balance between stability and adaptability.</span></p><p><span>Incremental learning finds applications in domains where the data distribution changes over time or when new data arrives continuously, such as online recommendation systems, adaptive control systems, fraud detection, and personalized learning systems.</span></p><h4 id='how-does-the-presence-of-irrelevant-features-affect-knn-performance-how-can-you-address-the-issue-of-feature-relevance'><span>How does the presence of irrelevant features affect KNN performance? How can you address the issue of feature relevance?</span></h4><p><span>The presence of irrelevant features can negatively impact KNN performance in several ways:</span></p><ul><li><p><span>Increased computation time: Irrelevant features contribute to the curse of dimensionality, making the distance calculations computationally expensive and less meaningful.</span></p></li><li><p><span>Noise and misclassification: Irrelevant features may introduce noise into the similarity measurements, leading to less accurate neighbor selection and potentially misclassifying instances.</span></p></li></ul><p><span>To address the issue of feature relevance in KNN, you can employ feature selection or dimensionality reduction techniques:</span></p><ul><li><p><span>Feature Selection: Selecting a subset of relevant features can improve KNN performance. Techniques such as Recursive Feature Elimination (RFE), L1 regularization (Lasso), or information gain can be applied to identify the most informative features that contribute to the prediction.</span></p></li><li><p><span>Dimensionality Reduction: Techniques like Principal Component Analysis (PCA), Linear Discriminant Analysis (LDA), or t-SNE can be used to reduce the dimensionality of the data while preserving the most important information. These methods transform the data into a lower-dimensional space, filtering out irrelevant features and reducing the impact of noise.</span></p></li></ul><p><span>By eliminating or reducing the influence of irrelevant features, you can improve the efficiency and accuracy of KNN predictions.</span></p><h4 id='what-is-the-difference-between-instance-based-learning-and-model-based-learning-which-category-does-knn-fall-into'><span>What is the difference between instance-based learning and model-based learning? Which category does KNN fall into?</span></h4><ul><li><p><span>Instance-based Learning: Instance-based learning, also known as lazy learning, involves storing the training instances and making predictions based on the similarity or distance between the new instance and the stored instances. It does not explicitly build a generalized model during the training phase but relies on the stored instances for inference. KNN falls into this category, as it directly uses the training instances to make predictions.</span></p></li><li><p><span>Model-based Learning: Model-based learning, also known as eager learning, involves constructing a generalized model from the training data during the training phase. The model represents a summary or abstraction of the data and is used for making predictions on new instances. Examples of model-based learning algorithms include decision trees, linear regression, and neural networks.</span></p></li></ul><p><span>In summary, </span><strong><span>instance-based learning algorithms</span></strong><span> like KNN directly store and use the training instances for predictions, while model-based learning algorithms build a generalized model during training and use it for inference.</span></p><h4 id='can-knn-be-used-for-text-classification-if-yes-how-would-you-represent-text-data-for-knn'><span>Can KNN be used for text classification? If yes, how would you represent text data for KNN?</span></h4><p><span>Yes, KNN can be used for text classification. However, text data requires appropriate representation before it can be used with KNN. Two commonly used representations for text data in KNN are:</span></p><ul><li><p><span>Bag-of-Words (BoW): In the BoW representation, each document is represented as a vector, and the vector&#39;s dimensions correspond to the unique words in the entire corpus. The value in each dimension represents the frequency or presence/absence of the word in the document. This way, text data is transformed into numerical feature vectors that can be used with KNN.</span></p></li><li><p><span>TF-IDF (Term Frequency-Inverse Document Frequency): TF-IDF is another representation that accounts for word frequency in a document as well as its relevance in the entire corpus. It assigns higher weights to words that appear frequently in a document but are rare in the corpus. TF-IDF transforms text data into numeric vectors similar to the BoW representation.</span></p></li></ul><p><span>These representations capture the information present in the text documents and allow KNN to measure similarity or distance between documents for classification purposes.</span></p><h4 id='how-does-the-concept-of-cross-validation-apply-to-knn-why-is-it-important'><span>How does the concept of cross-validation apply to KNN? Why is it important?</span></h4><p><span>Cross-validation is a technique used to assess the performance and generalization ability of a machine learning model. It can be applied to KNN as well. The basic idea behind cross-validation is to partition the available data into multiple subsets, or folds, and iteratively use one fold as a validation set while training the model on the remaining folds.</span></p><p><span>For KNN, cross-validation helps in evaluating the model&#39;s performance by providing an estimate of how well it will generalize to unseen data. Since KNN relies on the proximity of data points, the choice of K and the distance metric can significantly affect the model&#39;s performance. Cross-validation allows you to tune these hyperparameters by comparing the model&#39;s performance on different folds and selecting the values that yield the best results.</span></p><p><span>Cross-validation helps in mitigating the risk of overfitting, where the model performs well on the training data but poorly on unseen data. It provides a more robust assessment of the model&#39;s capabilities and helps in selecting the most suitable hyperparameters for KNN.</span></p><h4 id='are-there-any-variations-or-extensions-of-knn-can-you-mention-a-few-and-explain-their-advantages'><span>Are there any variations or extensions of KNN? Can you mention a few and explain their advantages?</span></h4><p><span>Yes, there are variations and extensions of KNN that address some of its limitations or incorporate additional techniques. Some examples include:</span></p><ul><li><p><span>Weighted KNN: In standard KNN, each neighbor has an equal vote in the prediction. Weighted KNN assigns weights to neighbors based on their proximity to the test instance. Closer neighbors have higher weights, indicating their stronger influence on the prediction.</span></p></li><li><p><span>Radius-based KNN: Instead of considering a fixed number of nearest neighbors, radius-based KNN considers all neighbors within a specified radius. This approach is useful when the density of neighbors varies across the feature space.</span></p></li><li><p><span>Kernel Density Estimation-based KNN: This variation combines KNN with kernel density estimation. It estimates the probability density function for each class in the feature space and assigns a class label based on the density of neighbors within a specified radius.</span></p></li><li><p><span>Locality-Sensitive Hashing (LSH) for KNN: LSH is a technique that allows for efficient approximate nearest neighbor search. It uses hash functions to index the data, enabling fast retrieval of neighbors without exhaustively calculating distances.</span></p></li></ul><p><span>These variations and extensions offer advantages such as improved flexibility, handling varying densities, incorporating weights, or providing faster neighbor search in high-dimensional spaces.</span></p><h4 id='how-can-you-interpret-the-results-of-a-knn-model-what-insights-can-you-gain-from-the-nearest-neighbors'><span>How can you interpret the results of a KNN model? What insights can you gain from the nearest neighbors?</span></h4><p><span>Interpreting the results of a KNN model involves analyzing the nearest neighbors of a given instance to gain insights and understand the reasoning behind the model&#39;s prediction. Here are some ways to interpret the results and the insights you can gain from the nearest neighbors:</span></p><ol><li><p><span>Class Distribution: By examining the class labels of the nearest neighbors, you can observe the distribution of classes. If the majority of the nearest neighbors belong to a specific class, it indicates that the prediction is influenced by instances with similar characteristics.</span></p></li><li><p><span>Decision Boundaries: The proximity of neighbors can provide insights into the decision boundaries of the model. By visualizing the nearest neighbors in relation to the predicted instance, you can understand how the model determines the boundaries between different classes.</span></p></li><li><p><span>Outlier Detection: If a predicted instance has nearest neighbors from different classes or distant neighbors, it suggests that the instance lies on the outskirts of the decision boundaries. This can be an indication of an ambiguous or outlier case.</span></p></li><li><p><span>Feature Importance: Examining the feature values of the nearest neighbors can help identify the important features that contribute to the prediction. Features that consistently differ between neighbors of different classes can be considered important for the decision-making process.</span></p></li><li><p><span>Similarity Patterns: By analyzing the attributes and characteristics of the nearest neighbors, you can identify patterns of similarity or dissimilarity. This can provide insights into the relationships between instances and help identify common traits or shared properties within classes.</span></p></li><li><p><span>Error Analysis: Investigating cases where the predicted class differs from the majority class of the nearest neighbors can help identify potential misclassifications or cases where the model struggles to generalize correctly. This analysis can guide further model improvements or data preprocessing steps.</span></p></li></ol><p><span>Overall, interpreting the results of a KNN model involves understanding the relationships between instances, exploring decision boundaries, identifying important features, detecting outliers, and gaining insights into the reasoning behind the model&#39;s predictions. By analyzing the nearest neighbors, you can gain a deeper understanding of how the model operates and make informed decisions about the model&#39;s performance and potential areas for improvement.</span></p><h3 id='python-application'><span>Python Application</span></h3><h4 id='using-sklearn'><span>Using Sklearn</span></h4><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 11.0759px; left: 42px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 38px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>24</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;" class="CodeMirror-activeline"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -38px; width: 38px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 29px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">datasets</span> <span class="cm-keyword">import</span> <span class="cm-variable">load_iris</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">model_selection</span> <span class="cm-keyword">import</span> <span class="cm-variable">train_test_split</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">neighbors</span> <span class="cm-keyword">import</span> <span class="cm-variable">KNeighborsClassifier</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">metrics</span> <span class="cm-keyword">import</span> <span class="cm-variable">accuracy_score</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Load the IRIS dataset</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">iris</span> <span class="cm-operator">=</span> <span class="cm-variable">load_iris</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Split the data into training and testing sets</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 29px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">X_train</span>, <span class="cm-variable">X_test</span>, <span class="cm-variable">y_train</span>, <span class="cm-variable">y_test</span> <span class="cm-operator">=</span> <span class="cm-variable">train_test_split</span>(<span class="cm-variable">iris</span>.<span class="cm-property">data</span>, <span class="cm-variable">iris</span>.<span class="cm-property">target</span>, <span class="cm-variable">test_size</span><span class="cm-operator">=</span><span class="cm-number">0.2</span>, <span class="cm-variable">random_state</span><span class="cm-operator">=</span><span class="cm-number">42</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Create a KNN classifier object</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">knn</span> <span class="cm-operator">=</span> <span class="cm-variable">KNeighborsClassifier</span>(<span class="cm-variable">n_neighbors</span><span class="cm-operator">=</span><span class="cm-number">3</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">15</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Train the classifier</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">knn</span>.<span class="cm-property">fit</span>(<span class="cm-variable">X_train</span>, <span class="cm-variable">y_train</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">17</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">18</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Make predictions on the test set</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">19</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">y_pred</span> <span class="cm-operator">=</span> <span class="cm-variable">knn</span>.<span class="cm-property">predict</span>(<span class="cm-variable">X_test</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 29px;">20</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">21</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Calculate accuracy</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">22</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">accuracy</span> <span class="cm-operator">=</span> <span class="cm-variable">accuracy_score</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">y_pred</span>)</span></pre></div><div class="" style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 29px;">23</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Accuracy:"</span>, <span class="cm-variable">accuracy</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 628px;"></div><div class="CodeMirror-gutters" style="height: 628px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 37px;"></div></div></div></div></pre><p><span>In this example, we first import the necessary modules: </span><code>load_iris</code><span> to load the IRIS dataset, </span><code>train_test_split</code><span> to split the data into training and testing sets, </span><code>KNeighborsClassifier</code><span> to create the KNN classifier, and </span><code>accuracy_score</code><span> to calculate the accuracy of the predictions.</span></p><p><span>Next, we load the IRIS dataset using </span><code>load_iris()</code><span>. We then split the dataset into training and testing sets using </span><code>train_test_split()</code><span>, where 80% of the data is used for training and 20% for testing.</span></p><p><span>We create a KNN classifier object </span><code>knn</code><span> with </span><code>n_neighbors=3</code><span>, indicating that the three nearest neighbors will be considered for classification.</span></p><p><span>The classifier is trained using the training data with </span><code>knn.fit(X_train, y_train)</code><span>. Then, we make predictions on the test set using </span><code>knn.predict(X_test)</code><span> and store the predicted labels in </span><code>y_pred</code><span>.</span></p><p><span>Finally, we calculate the accuracy of the predictions by comparing the predicted labels </span><code>y_pred</code><span> with the true labels </span><code>y_test</code><span> and print the accuracy score.</span></p><p><span>This example demonstrates a basic implementation of a KNN classifier using the IRIS dataset. You can modify the code or explore additional functionalities of scikit-learn to further enhance the application.</span></p><h5 id='kneighborsclassifier'><code>KNeighborsClassifier()</code></h5><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.8237px; left: 32px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -28px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">class</span> <span class="cm-def">sklearn</span>.<span class="cm-property">neighbors</span>.<span class="cm-property">KNeighborsClassifier</span>(<span class="cm-variable">n_neighbors</span><span class="cm-operator">=</span><span class="cm-number">5</span>, <span class="cm-variable">weights</span><span class="cm-operator">=</span><span class="cm-string">'uniform'</span>, <span class="cm-variable">algorithm</span><span class="cm-operator">=</span><span class="cm-string">'auto'</span>, <span class="cm-variable">leaf_size</span><span class="cm-operator">=</span><span class="cm-number">30</span>, <span class="cm-variable">p</span><span class="cm-operator">=</span><span class="cm-number">2</span>, <span class="cm-variable">metric</span><span class="cm-operator">=</span><span class="cm-string">'minkowski'</span>, <span class="cm-variable">metric_params</span><span class="cm-operator">=</span><span class="cm-keyword">None</span>, <span class="cm-variable">n_jobs</span><span class="cm-operator">=</span><span class="cm-keyword">None</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="height: 52px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><ul><li><p><code>n_neighbors</code><span>：指定要考虑的最近邻居的数量，通常是一个正整数，默认为5。</span></p></li><li><p><code>weights</code><span>：指定如何对邻居的权重进行计算，默认为&#39;uniform&#39;，表示所有邻居的权重相等。其他可选值包括&#39;distance&#39;（权重与距离成反比）和用户自定义的可调用函数。</span></p></li><li><p><code>algorithm</code><span>：指定用于计算最近邻居的算法。可选值包括&#39;auto&#39;（自动选择合适的算法）、&#39;ball_tree&#39;（使用BallTree算法）、&#39;kd_tree&#39;（使用KDTree算法）和&#39;brute&#39;（使用暴力搜索）。默认为&#39;auto&#39;。</span></p></li><li><p><code>leaf_size</code><span>：指定BallTree或KDTree的叶子节点大小，默认为30。较小的值将导致构建树的速度更慢但查询速度更快。</span></p></li><li><p><code>p</code><span>：指定Minkowski距离度量的参数。当</span><code>p=1</code><span>时，使用曼哈顿距离；当</span><code>p=2</code><span>时，使用欧氏距离。默认为2。</span></p></li><li><p><code>metric</code><span>：指定用于计算距离的度量标准，默认为&#39;minkowski&#39;。还可以选择其他度量标准，如&#39;euclidean&#39;、&#39;manhattan&#39;等。</span></p></li><li><p><code>metric_params</code><span>：指定距离度量标准的额外参数。默认为None。</span></p></li><li><p><code>n_jobs</code><span>：指定并行计算的作业数量。默认为None，表示不使用并行计算。</span></p></li></ul><p><span>KNeighborsClassifier的主要方法：</span></p><ul><li><p><code>fit(X, y)</code><span>：用于训练模型，其中</span><code>X</code><span>是训练数据的特征向量，</span><code>y</code><span>是对应的目标变量。</span></p></li><li><p><code>predict(X)</code><span>：用训练好的模型对新的数据进行预测，返回预测的目标变量。</span></p></li></ul><ul><li><p><code>predict_proba(X)</code><span>：返回每个类别的概率估计。仅在KNeighborsClassifier的</span><code>weights</code><span>参数设置为&#39;distance&#39;时可用。</span></p></li><li><p><code>kneighbors(X)</code><span>：返回测试集中每个样本的最近邻居。可以获取最近邻居的距离和索引。</span></p></li><li><p><code>score(X, y)</code><span>：返回给定测试数据和标签的平均准确率。</span></p></li></ul><p><span>KNeighborsClassifier的工作流程：</span></p><ol><li><p><span>初始化KNeighborsClassifier对象，并根据提供的参数设置模型的属性。</span></p></li><li><p><span>使用</span><code>fit(X, y)</code><span>方法将训练数据</span><code>X</code><span>和对应的目标变量</span><code>y</code><span>传递给模型，以训练KNN分类器。模型会根据提供的数据建立一个存储训练样本的数据结构，以便后续的预测和计算最近邻居。</span></p></li><li><p><span>当需要对新的样本进行分类时，使用</span><code>predict(X)</code><span>方法传递测试数据</span><code>X</code><span>给模型，返回预测的目标变量。KNN分类器会根据选择的最近邻居数量（</span><code>n_neighbors</code><span>）和距离度量（</span><code>metric</code><span>）来计算测试样本与训练样本之间的距离，然后根据最近邻居的标签进行投票或权重计算，确定预测结果。</span></p></li><li><p><span>可以使用其他方法如</span><code>predict_proba(X)</code><span>返回每个类别的概率估计，或使用</span><code>kneighbors(X)</code><span>获取测试集中每个样本的最近邻居的距离和索引。</span></p></li><li><p><span>使用</span><code>score(X, y)</code><span>方法可以评估模型的准确率，计算给定测试数据</span><code>X</code><span>和对应的真实标签</span><code>y</code><span>的平均准确率。</span></p></li></ol><h4 id='from-scratch'><span>From Scratch</span></h4><p><img src="https://machinelearningmastery.com/wp-content/uploads/2019/10/Develop-k-Nearest-Neighbors-in-Python-From-Scratch.png" referrerpolicy="no-referrer" alt="Develop k-Nearest Neighbors in Python From Scratch"></p><ul><li><p><strong><span>Step 1</span></strong><span>: Calculate Euclidean Distance.</span></p></li><li><p><strong><span>Step 2</span></strong><span>: Get Nearest Neighbors.</span></p></li><li><p><strong><span>Step 3</span></strong><span>: Make Predictions.</span></p></li></ul><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 11.0759px; left: 42px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 38px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>11</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;" class="CodeMirror-activeline"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -38px; width: 38px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 29px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">datasets</span> <span class="cm-keyword">import</span> <span class="cm-variable">load_iris</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">model_selection</span> <span class="cm-keyword">import</span> <span class="cm-variable">train_test_split</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">metrics</span> <span class="cm-keyword">import</span> <span class="cm-variable">accuracy_score</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Load the IRIS dataset</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">iris</span> <span class="cm-operator">=</span> <span class="cm-variable">load_iris</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Split the data into training and testing sets</span></span></pre></div><div class="" style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 29px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">X_train</span>, <span class="cm-variable">X_test</span>, <span class="cm-variable">y_train</span>, <span class="cm-variable">y_test</span> <span class="cm-operator">=</span> <span class="cm-variable">train_test_split</span>(<span class="cm-variable">iris</span>.<span class="cm-property">data</span>, <span class="cm-variable">iris</span>.<span class="cm-property">target</span>, <span class="cm-variable">test_size</span><span class="cm-operator">=</span><span class="cm-number">0.2</span>, <span class="cm-variable">random_state</span><span class="cm-operator">=</span><span class="cm-number">42</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 288px;"></div><div class="CodeMirror-gutters" style="height: 288px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 37px;"></div></div></div></div></pre><p><span>首先，导入所需的库。使用</span><code>load_iris</code><span>函数加载IRIS数据集，然后使用</span><code>train_test_split</code><span>函数将数据集划分为训练集和测试集，其中测试集占比为20%。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 11.0759px; left: 32px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;" class="CodeMirror-activeline"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -28px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">euclidean_distance</span>(<span class="cm-variable">x1</span>, <span class="cm-variable">x2</span>):</span></pre></div><div class="" style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">np</span>.<span class="cm-property">sqrt</span>(<span class="cm-variable">np</span>.<span class="cm-property">sum</span>((<span class="cm-variable">x1</span> <span class="cm-operator">-</span> <span class="cm-variable">x2</span>)<span class="cm-operator">**</span><span class="cm-number">2</span>))</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="height: 52px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>定义一个计算欧氏距离的函数</span><code>euclidean_distance</code><span>，输入两个向量x1和x2，使用numpy的函数计算两个向量之间的差的平方和，然后取平方根作为欧氏距离。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 11.0759px; left: 42px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 38px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>18</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;" class="CodeMirror-activeline"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -38px; width: 38px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 29px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">class</span> <span class="cm-def">KNN</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">def</span> <span class="cm-def">__init__</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">n_neighbors</span><span class="cm-operator">=</span><span class="cm-number">3</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">self</span>.<span class="cm-property">n_neighbors</span> <span class="cm-operator">=</span> <span class="cm-variable">n_neighbors</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">def</span> <span class="cm-def">fit</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">X</span>, <span class="cm-variable">y</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">self</span>.<span class="cm-property">X_train</span> <span class="cm-operator">=</span> <span class="cm-variable">X</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">self</span>.<span class="cm-property">y_train</span> <span class="cm-operator">=</span> <span class="cm-variable">y</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">def</span> <span class="cm-def">predict</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">X</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 29px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">y_pred</span> <span class="cm-operator">=</span> []</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">for</span> <span class="cm-variable">sample</span> <span class="cm-keyword">in</span> <span class="cm-variable">X</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">distances</span> <span class="cm-operator">=</span> [<span class="cm-variable">euclidean_distance</span>(<span class="cm-variable">sample</span>, <span class="cm-variable">x</span>) <span class="cm-keyword">for</span> <span class="cm-variable">x</span> <span class="cm-keyword">in</span> <span class="cm-variable-2">self</span>.<span class="cm-property">X_train</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">nearest_indices</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">argsort</span>(<span class="cm-variable">distances</span>)[:<span class="cm-variable-2">self</span>.<span class="cm-property">n_neighbors</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">nearest_labels</span> <span class="cm-operator">=</span> <span class="cm-variable-2">self</span>.<span class="cm-property">y_train</span>[<span class="cm-variable">nearest_indices</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">15</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">counts</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">bincount</span>(<span class="cm-variable">nearest_labels</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">y_pred</span>.<span class="cm-property">append</span>(<span class="cm-variable">np</span>.<span class="cm-property">argmax</span>(<span class="cm-variable">counts</span>))</span></pre></div><div class="" style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 29px;">17</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">np</span>.<span class="cm-property">array</span>(<span class="cm-variable">y_pred</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 445px;"></div><div class="CodeMirror-gutters" style="height: 445px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 37px;"></div></div></div></div></pre><p><span>定义KNN类。在</span><code>__init__</code><span>方法中初始化最近邻居的数量</span><code>n_neighbors</code><span>。</span><code>fit</code><span>方法用于存储训练数据</span><code>X</code><span>和对应的目标变量</span><code>y</code><span>。</span><code>predict</code><span>方法用于对输入的测试数据</span><code>X</code><span>进行预测。对于每个测试样本，计算它与训练样本的距离，选择最近的</span><code>n_neighbors</code><span>个样本，进行多数投票并返回预测结果。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 11.0759px; left: 32px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;" class="CodeMirror-activeline"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -28px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">knn</span> <span class="cm-operator">=</span> <span class="cm-variable">KNN</span>(<span class="cm-variable">n_neighbors</span><span class="cm-operator">=</span><span class="cm-number">3</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Train the classifier</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">knn</span>.<span class="cm-property">fit</span>(<span class="cm-variable">X_train</span>, <span class="cm-variable">y_train</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Make predictions on the test set</span></span></pre></div><div class="" style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">y_pred</span> <span class="cm-operator">=</span> <span class="cm-variable">knn</span>.<span class="cm-property">predict</span>(<span class="cm-variable">X_test</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 183px;"></div><div class="CodeMirror-gutters" style="height: 183px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>创建一个KNN对象</span><code>knn</code><span>，并指定最近邻居的数量为3。然后，使用训练集调用</span><code>fit</code><span>方法训练分类器。接下来，使用测试集调用</span><code>predict</code><span>方法进行预测，将预测结果存储在</span><code>y_pred</code><span>中。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 11.0759px; left: 32px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;" class="CodeMirror-activeline"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -28px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">accuracy</span> <span class="cm-operator">=</span> <span class="cm-variable">accuracy_score</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">y_pred</span>)</span></pre></div><div class="" style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Accuracy:"</span>, <span class="cm-variable">accuracy</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="height: 52px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>计算预测结果的准确率。使用</span><code>accuracy_score</code><span>函数，将真实的目标变量</span><code>y_test</code><span>和预测的目标变量</span><code>y_pred</code><span>作为输入参数，计算准确率。最后打印准确率的结果。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 11.0759px; left: 42px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 38px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>45</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;" class="CodeMirror-activeline"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -38px; width: 38px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 29px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">datasets</span> <span class="cm-keyword">import</span> <span class="cm-variable">load_iris</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">model_selection</span> <span class="cm-keyword">import</span> <span class="cm-variable">train_test_split</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">metrics</span> <span class="cm-keyword">import</span> <span class="cm-variable">accuracy_score</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Load the IRIS dataset</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">iris</span> <span class="cm-operator">=</span> <span class="cm-variable">load_iris</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Split the data into training and testing sets</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 29px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">X_train</span>, <span class="cm-variable">X_test</span>, <span class="cm-variable">y_train</span>, <span class="cm-variable">y_test</span> <span class="cm-operator">=</span> <span class="cm-variable">train_test_split</span>(<span class="cm-variable">iris</span>.<span class="cm-property">data</span>, <span class="cm-variable">iris</span>.<span class="cm-property">target</span>, <span class="cm-variable">test_size</span><span class="cm-operator">=</span><span class="cm-number">0.2</span>, <span class="cm-variable">random_state</span><span class="cm-operator">=</span><span class="cm-number">42</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">euclidean_distance</span>(<span class="cm-variable">x1</span>, <span class="cm-variable">x2</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">np</span>.<span class="cm-property">sqrt</span>(<span class="cm-variable">np</span>.<span class="cm-property">sum</span>((<span class="cm-variable">x1</span> <span class="cm-operator">-</span> <span class="cm-variable">x2</span>)<span class="cm-operator">**</span><span class="cm-number">2</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">15</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">class</span> <span class="cm-def">KNN</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">def</span> <span class="cm-def">__init__</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">n_neighbors</span><span class="cm-operator">=</span><span class="cm-number">3</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">17</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">self</span>.<span class="cm-property">n_neighbors</span> <span class="cm-operator">=</span> <span class="cm-variable">n_neighbors</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">18</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">19</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">def</span> <span class="cm-def">fit</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">X</span>, <span class="cm-variable">y</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 29px;">20</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">self</span>.<span class="cm-property">X_train</span> <span class="cm-operator">=</span> <span class="cm-variable">X</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">21</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-2">self</span>.<span class="cm-property">y_train</span> <span class="cm-operator">=</span> <span class="cm-variable">y</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">22</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">23</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">def</span> <span class="cm-def">predict</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">X</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">24</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">y_pred</span> <span class="cm-operator">=</span> []</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">25</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">for</span> <span class="cm-variable">sample</span> <span class="cm-keyword">in</span> <span class="cm-variable">X</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">26</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">distances</span> <span class="cm-operator">=</span> [<span class="cm-variable">euclidean_distance</span>(<span class="cm-variable">sample</span>, <span class="cm-variable">x</span>) <span class="cm-keyword">for</span> <span class="cm-variable">x</span> <span class="cm-keyword">in</span> <span class="cm-variable-2">self</span>.<span class="cm-property">X_train</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">27</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">nearest_indices</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">argsort</span>(<span class="cm-variable">distances</span>)[:<span class="cm-variable-2">self</span>.<span class="cm-property">n_neighbors</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">28</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">nearest_labels</span> <span class="cm-operator">=</span> <span class="cm-variable-2">self</span>.<span class="cm-property">y_train</span>[<span class="cm-variable">nearest_indices</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">29</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">counts</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">bincount</span>(<span class="cm-variable">nearest_labels</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 29px;">30</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">y_pred</span>.<span class="cm-property">append</span>(<span class="cm-variable">np</span>.<span class="cm-property">argmax</span>(<span class="cm-variable">counts</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">31</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">np</span>.<span class="cm-property">array</span>(<span class="cm-variable">y_pred</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">32</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">33</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Create KNN classifier object</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">34</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">knn</span> <span class="cm-operator">=</span> <span class="cm-variable">KNN</span>(<span class="cm-variable">n_neighbors</span><span class="cm-operator">=</span><span class="cm-number">3</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">35</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">36</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Train the classifier</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">37</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">knn</span>.<span class="cm-property">fit</span>(<span class="cm-variable">X_train</span>, <span class="cm-variable">y_train</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">38</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">39</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Make predictions on the test set</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 29px;">40</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">y_pred</span> <span class="cm-operator">=</span> <span class="cm-variable">knn</span>.<span class="cm-property">predict</span>(<span class="cm-variable">X_test</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">41</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">42</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Calculate accuracy</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 29px;">43</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">accuracy</span> <span class="cm-operator">=</span> <span class="cm-variable">accuracy_score</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">y_pred</span>)</span></pre></div><div class="" style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 29px;">44</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Accuracy:"</span>, <span class="cm-variable">accuracy</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1177px;"></div><div class="CodeMirror-gutters" style="height: 1177px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 37px;"></div></div></div></div></pre><p>&nbsp;</p></div></div>
</body>
</html>